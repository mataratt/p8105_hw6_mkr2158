Homework 6
================
Matariya Rattanapan
2025-12-03

## Problem 1

N/A

## Problem 2

Cleaning up `weather_df` data, fitting linear model, and bootstrapping

``` r
weather_df =
  weather_df |> 
  drop_na(tmax, tmin, prcp)

#Fitting linear model

fit = lm(tmax ~ tmin + prcp, data = weather_df)

#Bootstrapping
weather_bootstrap =
  weather_df |> 
  modelr::bootstrap(n = 5000) |> 
  mutate(
    models = map(strap, \(df) lm(tmax ~ tmin + prcp, data = df)),
    glance = map(models, broom::glance),
    tidy   = map(models, broom::tidy)
  )

#Getting bootstrapped r2
r2 =
  weather_bootstrap |> 
  unnest(glance) |> 
  select(.id, r.squared)

#Getting beta1 and beta2

betas =
  weather_bootstrap |> 
  unnest(tidy) |> 
  filter(term %in% c("tmin", "prcp")) |> 
  select(.id, term, estimate) |> 
  pivot_wider(
    names_from = term,
    values_from = estimate
  ) |> 
  rename(
    beta1 = tmin,
    beta2 = prcp
  ) |> 
  mutate(
    beta_ratio = beta1/beta2
  )

#Combining estimates into one df
weather_estimates =
  left_join(r2, betas, by=".id")
```
